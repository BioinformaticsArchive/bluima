
# works: F1=0.90, YEAH!
# WARNING: needed to fix some preprocessing and find the right token_freq file (tabs and lemmatized!)

# BR NER evaluation with topics
# this ns abstracts dca model works,
# copy of preprocess_pubmed_ns.pipeline
# takes about 20h with 4 trails


#cr: PubmedDatabaseCR
# between__java: new int[]{ 128 , 350 }
# db_connection__java: new String[] { "localhost", "bb_pubmed", "root", "" }

cr: WhiteTextCollectionReader
# maxNrResults__java: 3

include: ../../../includes/preprocess.incl

# lexicon-based from MT
ae_java: ch.epfl.bbp.uima.LexicaHelper.getConceptMapper("blueonto1/age")

ae_java: ch.epfl.bbp.uima.LexicaHelper.getConceptMapper("blueonto1/disease")

ae_java: ch.epfl.bbp.uima.LexicaHelper.getConceptMapper("blueonto1/ionchannel")

ae_java: ch.epfl.bbp.uima.LexicaHelper.getConceptMapper("blueonto1/method")

ae_java: ch.epfl.bbp.uima.LexicaHelper.getConceptMapper("blueonto1/molecule")

ae_java: ch.epfl.bbp.uima.LexicaHelper.getConceptMapper("blueonto1/organism")

ae_java: ch.epfl.bbp.uima.LexicaHelper.getConceptMapper("blueonto1/region")

ae_java: ch.epfl.bbp.uima.LexicaHelper.getConceptMapper("blueonto1/sex")

# lexicon-based from Biolexicon, OBO & co
ae_java: ch.epfl.bbp.uima.LexicaHelper.getConceptMapper("/biolexicon/biolexicon_senses")

# ok??
ae_java: ch.epfl.bbp.uima.LexicaHelper.getConceptMapper("/brainregions/neuronames")

ae_java: ch.epfl.bbp.uima.LexicaHelper.getConceptMapper("/onto_baseline/cell")

ae_java: ch.epfl.bbp.uima.LexicaHelper.getConceptMapper("/onto_baseline/disease")

ae_java: ch.epfl.bbp.uima.LexicaHelper.getConceptMapper("/onto_baseline/protein")

ae_java: ch.epfl.bbp.uima.LexicaHelper.getConceptMapper("/onto_baseline/verb")

######################
ae: PunctuationAnnotator

ae: WordnetAnnotator

ae: GeneralEnglishAnnotator

ae_java: ch.epfl.bbp.uima.ae.MeasureRegexAnnotators.getAllAED()

ae: PruneMeasuresAnnotator

ae: LinnaeusAnnotator


######################
ae: SkipSomePosAnnotator

ae: CountAnnotationsAnnotator
 annotationClass: ch.epfl.bbp.uima.types.BrainRegion

ae: ViterbiFilterAnnotator

ae: CountAnnotationsAnnotator
 annotationClass: ch.epfl.bbp.uima.types.BrainRegion

# DCA #######################################

#FIXME
#ae: FeatureTokensFilterAnnotator2
# caseSensitive: false
# #tokenFrequencyFile: $ROOT/models/20130525_ns_abstracts/20130309_preprocess_pubmed_ns.pipeline/dca/20130405_token_frequency_min10
# tokenFrequencyFile: $ROOT/modules/bluima_topic_models/resources/models/20130309_preprocess_pubmed_ns.pipeline_min/dca/20130405_token_frequency_min10
# minimumFrequency: 100
# maximumFrequency__java: Integer.MAX_VALUE
# stopwordsFilePath: $ROOT/modules/bluima_topic_models/src/main/resources/stoplists/mallet_stopwords_en.txt
#ae: FeatureTokensExtractionAnnotator2

ae: ch.epfl.bbp.uima.topicmodels.annotators.DCATopicModelsAnnotator
 #dcaDirectoryPath: $ROOT/models/20130525_ns_abstracts/20130309_preprocess_pubmed_ns.pipeline/dca
 dcaDirectoryPath: $ROOT/modules/bluima_topic_models/resources/models/20130309_preprocess_pubmed_ns.pipeline_min/dca
 dcaStem: dca
 inferenceIterations: 100
 inferenceBurnin: 20

#ae: ch.epfl.bbp.uima.topicmodels.writers.exploitation.AnnotateTokensWithTopicWriter
# outputDir: target
# latexOutput: true

#ae: ch.epfl.bbp.uima.topicmodels.writers.exploitation.TopicDistributionWriter
# outputDir: target
# command: R --vanilla --slave -f $ROOTmodules/bluima_topic_models/scripts/plot_doc_topic_distribution.R --args {input} {output}


# MALLET BRAINREGION NER ##################################

ae: BrainRegionAnnotator
 mode: eval
 trials__java: 10;

#ae: BartWriter
# batchPrefix: 20130607_brainregions

#ae: PrintAnnotationInSentenceWriter
# annotationClass: ch.epfl.bbp.uima.types.BrainRegion
# outputFile: target/20130607_extracted_brs_abstracts.html


ae: StatsAnnotatorPlus
 printEvery__java: 100
